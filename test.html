<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SEO Backend Tester</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; line-height: 1.6; }
        input { width: 70%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
        button { padding: 10px 20px; cursor: pointer; background: #28a745; color: white; border: none; border-radius: 4px; }
        pre { background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; border: 1px solid #ddd; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>

    <h2>üîç SEO API Tester</h2>
    <p>Enter a full URL (including http/https) to test your Flask backend.</p>

    <input type="text" id="urlInput" placeholder="https://example.com">
    <button onclick="runAudit()">Analyze Site</button>

    <h3>Result:</h3>
    <div id="loading" style="display:none;">Analyzing... please wait...</div>
    <pre id="output">Results will appear here...</pre>

    <script>
        async function runAudit() {
            const urlValue = document.getElementById('urlInput').value;
            const output = document.getElementById('output');
            const loading = document.getElementById('loading');

            if (!urlValue) {
                alert("Please enter a URL first!");
                return;
            }

            loading.style.display = "block";
            output.innerText = "Processing...";

            try {
                // Connecting to your local Flask server
                const response = await fetch('http://127.0.0.1:5000/api/audit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ url: urlValue })
                });

                const data = await response.json();
                
                // Display the JSON response nicely
                output.innerText = JSON.stringify(data, null, 2);
                output.classList.remove('error');

            } catch (error) {
                output.innerText = "Error: " + error.message + 
                                 "\n\nCheck if your Flask server is running at http://127.0.0.1:5000";
                output.classList.add('error');
            } finally {
                loading.style.display = "none";
            }
        }
    </script>
</body>
</html>